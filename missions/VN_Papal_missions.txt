#Papal missions
#by ShyGuy13

vn_pap_missions_slot_1 = {
    slot = 6
    generic = no
    ai = yes
    potential = {
        tag = PAP
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_pap_expedition_to_barbastro = {
        icon = mission_turning_the_tables
        position = 1
        required_missions = {  }
        trigger = {
            if = {
                limit = { has_dlc = "Emperor" }
                curia_treasury_size = 2500
            }
            else = {
                treasury = 500
            }
            manpower = 10
            prestige = 10
        }
        effect = {
            hidden_effect = {
                random_list = {
                    75 = { set_global_flag = victory_at_barbastro }
                    25 = { set_global_flag = failure_at_barbastro }
                }
            }
            country_event = {
                id = vn_missions.40
            }
        }
    }
    vn_pap_sanction_the_reconquista = {
        icon = king_of_aragon
        position = 2
        required_missions = { vn_pap_expedition_to_barbastro }
        provinces_to_highlight = {
            is_capital = yes
            owner = {
                NOT = { tag = ROOT }
                capital_scope = {
                    superregion = iberia_superregion
                }
                religion = catholic
                NOT = {
                    has_opinion = {
                        who = ROOT
                        value = 100
                    }
                }
            }
        }
        trigger = {
            calc_true_if = {
                desc = vn_pap_sanction_the_reconquista.tt
                all_country = {
                    capital_scope = {
                        superregion = iberia_superregion
                    }
                    religion = catholic
                    has_opinion = {
                        who = ROOT
                        value = 100
                    }
                }
                amount = 2
            }
        }
        effect = {
            custom_tooltip = vn_pap_sanction_the_reconquista.ss
            hidden_effect = {
                every_country = {
                    limit = {
                        NOT = { tag = ROOT }
                        capital_scope = {
                            superregion = iberia_superregion
                        }
                        religion = catholic
                    }
                    country_event = { id = flavor_pap.12 }
                }
            }
        }
    }
    vn_pap_christian_iberia = {
        icon = a_question_of_spain
        position = 3
        required_missions = { vn_pap_sanction_the_reconquista }
        provinces_to_highlight = {
            superregion = iberia_superregion
            owner = {
                NOT = { religion_group = christian }
            }
        }
        trigger = {
            iberia_superregion = {
                type = all
                owner = {
                    religion_group = christian
                }
            }
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 25 } 
            
        }
    }
    vn_pap_missionaries_to_sweden = {
        icon = catholic_confraternity
        position = 4
		required_missions = {  }
		provinces_to_highlight = {
            if = {
                limit = { exists = SWE }
                owned_by = SWE
                is_capital = yes
            }
            else = {
                OR = {
					area = ostergotland_area
					area = vastergotland_area
					area = dalsland_area
                }
                NOT = { religion = catholic }
            }
		}
        trigger = {
            if = {
				limit = {
					exists = SWE
                }
                OR = {
                    SWE = {
                        religion = catholic
                        has_opinion = {
                            who = ROOT
                            value = 100
                        }
                    }
                    SWE = {
                        NOT = { religion = catholic }
                        NOT = { num_of_cities = 75 }
                    }
                }
			}
			else = {
                ostergotland_area = {
					type = all
					religion = catholic
				}
                vastergotland_area = {
					type = all
					religion = catholic
				}
                dalsland_area = {
					type = all
					religion = catholic
				}
			}
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 10 } 
            custom_tooltip = vn_pap_missionaries_to_sweden.tt
            hidden_effect = {
                every_country = {
                    limit = {
                        NOT = { tag = ROOT }
                        capital_scope = {
                            superregion = scandinavia_superregion
                        }
                        religion = catholic
                    }
                    country_event = { id = flavor_pap.12 }
                }
            }
        }
    }
    vn_pap_northern_crusades = {
        icon = mission_crusade
        position = 5
        required_missions = { vn_pap_missionaries_to_sweden }
        provinces_to_highlight = {
            OR = {
                province_id = 402
                province_id = 5793
            }
        }
        trigger = {
            OR = {
                custom_trigger_tooltip = {
                    tooltip = vn_pap_northern_crusades.tt
                    OR = {
                        has_global_flag = danzig_delivered
                        has_global_flag = riga_delivered
                    }
                }
                is_year = 1500
            }
        }
        effect = {
            add_army_tradition = 20
            custom_tooltip = vn_pap_northern_crusades.ss
            hidden_effect = {
                if = {
                    limit = { TEU = { religion = catholic } }
                    TEU = {
                        country_event = { id = flavor_pap.12 }
                    }
                }
                if = {
                    limit = { LIV = { religion = catholic } }
                    LIV = {
                        country_event = { id = flavor_pap.12 }
                    }
                }
            }
        }
    }
    vn_pap_european_christianization = {
        icon = spread_piety
        position = 6
        required_missions = { vn_pap_northern_crusades }
        provinces_to_highlight = {
            OR = {
                province_id = 6109 # Stockholm
                province_id = 402 # Danzig
                province_id = 5793 # Riga
                province_id = 410 # Waren
                province_id = 5752 # Kaunas
                province_id = 5889 # Tallin
                province_id = 2041 # Palermo
                province_id = 555 # Syracuse
                province_id = 1135 # Lisboa
                province_id = 1867 # Sevilla
                province_id = 443 # Granada
                province_id = 2024 # Valencia
                province_id = 2233 # Constantinople
            }
            NOT = { religion_group = christian }
        }
        trigger = {
            6109 = { religion_group = christian }
            402 = { religion_group = christian }
            5793 = { religion_group = christian }
            410 = { religion_group = christian }
            5752 = { religion_group = christian }
            5889 = { religion_group = christian }
            2041 = { religion_group = christian }
            555 = { religion_group = christian }
            1135 = { religion_group = christian }
            1867 = { religion_group = christian }
            443 = { religion_group = christian }
            2024 = { religion_group = christian }
            2233 = { religion_group = christian }
        }
        effect = {
            add_adm_power = 75
            add_dip_power = 75
            add_mil_power = 75
            add_country_modifier = {
                name = pap_european_christianization_mission
                duration = 18250
            }
        }
    }
    vn_pap_milites_christianus = {
        icon = catholic_volunteers
        position = 7
        required_missions = {  }
        trigger = {
            army_size = 25
            army_size_percentage = 0.75
            manpower_percentage = 0.75
            land_maintenance = 1
        }
        effect = {
            add_army_tradition = 5
            add_army_professionalism = 0.02
            create_general = {
                tradition = 75
            }
        }
	}
    vn_pap_form_the_inquistion = {
        icon = support_the_orders
        position = 10
        required_missions = { vn_pap_milites_christianus }
        trigger = {
            is_religion_enabled = waldensian
            is_religion_enabled = cathar
            is_religion_enabled = fraticelli
        }
        effect = {
            country_event = {
                id = fbievents.74
            }
        }
    }
    vn_pap_weather_the_reformation = {
        icon = victor_for_the_true_faith
        position = 11
        required_missions = { vn_pap_form_the_inquistion }
        trigger = {
            is_religion_enabled = protestant
            is_religion_enabled = reformed
            num_of_missionaries = 3
        }
        effect = {
            add_stability_or_adm_power = yes
        }
    }
    vn_pap_council_of_trent = {
        icon = counter_reformation
        position = 12
        required_missions = { vn_pap_weather_the_reformation }
        trigger = {
            if = {
                limit = { has_dlc = "Emperor" }
                OR = {
                    custom_trigger_tooltip = {
                        tooltip = obj_convert_10_provinces_tooltip
                        check_variable = { which = num_converted_religion value = 10 }
                    }
                    AND = {
                        is_council_enabled = yes
                        OR = {
                            council_position = concilatory
                            council_position = harsh
                        }
                    }
                }
            }
            else = {
                custom_trigger_tooltip = {
					tooltip = obj_convert_10_provinces_tooltip
					check_variable = { which = num_converted_religion value = 10 }
				}
            }
        }
        effect = {
            if = {
                limit = { has_dlc = "Emperor" }
                custom_tooltip = council_of_trent_members_tt
                hidden_effect = {
                    every_country = {
                        limit = {
                            OR = {
                                council_position = concilatory
                                council_position = harsh
                            }
                        }
                        add_opinion = {
                            who = ROOT
                            modifier = council_of_trent_participation
                        }
                    }
                }
            }
            else = {
                add_dip_power = 100
            }
        }
    }
    vn_pap_league_wars = {
        icon = back_the_league
        position = 13
        required_missions = { vn_pap_council_of_trent }
        trigger = {
            if = {
				limit = { 
					has_dlc = "Art of War"
					hre_leagues_enabled = yes
					hre_religion_treaty = no
					hre_religion_locked = no
					any_country = {
						is_emperor = yes
					}
				}
				in_league = catholic
			}
			else_if = {
				limit = { any_country = { is_emperor = yes } }
				calc_true_if = {
                    amount = 3
                    all_ally = {
                        religion = catholic
					    is_part_of_hre = yes
                    }
                }
			}
			else = {
				any_ally = {
					religion = catholic
					capital_scope = {
						OR = {
                            region = north_germany_region
                            region = south_germany_region
						}
					}
				}
			}
        }
        effect = {
            if = {
				limit = { 
					has_dlc = "Art of War" 
					any_country = {
						is_emperor = yes
					}
					NOT = {
						hre_religion_locked = yes
						hre_religion_treaty = yes
						NOT = { hre_religion = catholic }
					}
				}
				custom_tooltip = emp_pap_back_the_catholic_powers_league_tt
				hidden_effect = {
					every_country = {
						limit = {
							NOT = { tag = ROOT }
							in_league = catholic
							NOT = { has_country_modifier = pap_papal_military_aid }
						}
						add_country_modifier = {
							name = pap_papal_military_aid
							duration = 3650
						}
					}
				}
			}
			else_if = {
				limit = {
					any_country = {
						is_emperor = yes
					}
				}
				every_ally = {
					limit = {
						religion = catholic
						is_part_of_hre = yes
					}
					add_country_modifier = {
						name = pap_papal_military_aid
						duration = 3650
					}
				}
			}
			else = {
				every_ally = {
					limit = {
						religion = catholic
						capital_scope = {
							OR = {
                                region = north_germany_region
                                region = south_germany_region
							}
						}
					}
					add_country_modifier = {
						name = pap_papal_military_aid
						duration = 3650
					}
				}
			}
			add_stability = 1
			add_war_exhaustion = -2
        }
    }
    vn_pap_catholic_italy = {
        icon = mission_rule_italy
        position = 14
        required_missions = { vn_pap_league_wars }
        provinces_to_highlight = {
            superregion = italy_superregion
            NOT = { religion = catholic }
        }
        trigger = {
            italy_superregion = {
                type = all
                religion = catholic
            }
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 20 } 
            add_country_modifier = {
                name = pap_catholic_italy_mission
                duration = 18250
            }
        }
	}
}

vn_pap_missions_slot_2 = {
    slot = 7
    generic = no
    ai = yes
    potential = {
        tag = PAP
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_pap_supremacy_and_infallibility = {
        icon = answer_the_roman_question
        position = 2
        required_missions = { vn_pap_in_nomine_domini }
        trigger = {
            OR = {
                NOT = { is_part_of_hre = yes }
                is_elector = yes
            }
            NOT = { war_with = emperor }
        }
        effect = {
            add_country_modifier = {
                name = pap_supremacy_and_infallibility_mission
                duration = 9125
            }
        }
    }
    vn_pap_fight_for_the_pontificate = {
        icon = holy_state
        position = 3
        required_missions = { vn_pap_supremacy_and_infallibility }
        trigger = {
            is_papal_controller = yes
            OR = {
                AND = {
                    faction_in_power = pap_orsini
                    faction_influence = {
                        faction = pap_orsini
                        influence = 60
                    }
                    NOT = { corruption = 0.01 }
                }
                AND = {
                    faction_in_power = pap_roman_mob
                    faction_influence = {
                        faction = pap_roman_mob
                        influence = 60
                    }
                    devotion = 95
                }
                AND = {
                    faction_in_power = pap_colonna
                    faction_influence = {
                        faction = pap_colonna
                        influence = 60
                    }
                    stability = 2
                }
                custom_trigger_tooltip = {
                    tooltip = vn_pap_fight_for_the_pontificate.tt
                    has_global_flag = pax_romana
                }
            }
        }
        effect = {
            if = {
                limit = {
                    faction_in_power = pap_orsini
                }
                add_adm_power = 75
            }
            else_if = {
                limit = {
                    faction_in_power = pap_colonna
                }
                add_dip_power = 75
            }
            else_if = {
                limit = {
                    faction_in_power = pap_roman_mob
                }
                add_mil_power = 75
            }
            else = {
                add_stability_or_adm_power = yes
            }
            add_country_modifier = {
                name = pap_fight_for_the_pontificate_mission
                duration = 9125
            }
        }
    }
    vn_pap_influence_the_electors = {
        icon = influence_the_princes
        position = 5
        required_missions = { vn_pap_guelphs_and_ghibellines }
        provinces_to_highlight = {
            is_capital = yes
            owner = {
                NOT = { tag = ROOT }
                is_elector = yes
                NOT = {
                    has_opinion = {
						who = ROOT
						value = 100
					}
                }
            }
        }
        trigger = {
            if = {
                limit = {
                    hre_size = 1
                }
                calc_true_if = {
                    amount = 5
                    all_elector = {
                        has_opinion = {
                            who = ROOT
                            value = 100
                        }
                    }
                }
                emperor = {
                    has_regency = no
                    has_consort_regency = no
                }
            }
			else = {
                total_development = 750
            }
        }
        effect = {
            emperor = {
				country_event = {
                    id = vn_missions.43
                }
            }
            add_country_modifier = {
                name = pap_influence_the_electors_mission_b
                duration = 9125
            }
        }
    }
    vn_pap_italian_emperorship = {
        icon = invest_in_the_provinces
        position = 6
        required_missions = { vn_pap_influence_the_electors vn_pap_guelphian_victory }
        trigger = {
            if = {
                limit = {
                    hre_size = 1
                }
                custom_trigger_tooltip = {
                    tooltip = vn_pap_italian_emperorship.tt
                    emperor = {
                        culture_group = latin
                        capital_scope = {
            superregion = italy_superregion
                        }
                    }
                }
            }
            else = {
                total_development = 1000
            }
        }
        effect = {
            add_dip_power = 100
            emperor = {
                add_prestige_or_monarch_power = { amount = 10 } 
                random_owned_province = {
                    limit = {
                        has_cardinal = no
                        religion = catholic
                    }
                    add_cardinal = yes
                }
            }
        }
    }
    vn_pap_council_of_clermont = {
        icon = shield_of_christendom
        position = 7
        required_missions = {  }
        trigger = {
            OR = {
				current_age = age_of_discovery
                current_age = age_of_reformation
                current_age = age_of_absolutism
                current_age = age_of_revolutions
                custom_trigger_tooltip = {
                    tooltip = vn_pap_council_of_clermont.tt
                    OR = {
                        any_country = {
                            is_in_war = {
                                casus_belli = cb_grand_crusade
                            }
                            ROOT = {
                                war_score_against = {
                                    who = PREV
                                    value = 10
                                }
                            }
                        }
                        any_country = {
                            is_in_war = {
                                casus_belli = cb_grand_heretic
                            }
                            ROOT = {
                                war_score_against = {
                                    who = PREV
                                    value = 10
                                }
                            }
                        }
                    }
                }
            }
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 15 } 
            add_mil_power = 50
            custom_tooltip = vn_pap_council_of_clermont.ss
            hidden_effect = {
                every_country = {
                    limit = {
                        religion = catholic
                        NOT = { war_with = ROOT }
                        OR = {
                            is_in_war = {
                                casus_belli = cb_grand_crusade
                            }
                            is_in_war = {
                                casus_belli = cb_grand_heretic
                            }
                        }
                    }
                    add_country_modifier = {
                        name = pap_council_of_clermont_mission
                        duration = 1825
                    }
                }
            }
        }
    }
    vn_pap_conquer_jerusalem = {
        icon = jerusalem
        position = 8
        required_missions = { vn_pap_council_of_clermont }
        provinces_to_highlight = {
            OR = {
                province_id = 4974
                province_id = 3027
                province_id = 3053
            }
            NOT = {
                owner = {
                    religion = catholic
                }
            }
        }
        trigger = {
            4974 = {
                owner = {
                    religion = catholic
                }
            }
            3027 = {
                owner = {
                    religion = catholic
                }
            }
            3053 = {
                owner = {
                    religion = catholic
                }
            }

        }
        effect = {
            custom_tooltip = vn_pap_conquer_jerusalem.tt
            hidden_effect = {
                every_country = {
                    limit = {
                        NOT = { tag = ROOT }
                        capital_scope = {
                            superregion = levant_superregion
                        }
                        religion = catholic
                    }
                    country_event = { id = flavor_pap.12 }
                }
            }
        }
    }
    vn_pap_revive_christian_communities = {
        icon = levantine_missions
        position = 9
        required_missions = { vn_pap_conquer_jerusalem }
        provinces_to_highlight = {
            superregion = levant_superregion
            NOT = { religion = catholic }
        }
        trigger = {
            calc_true_if = {
                amount = 50
                desc = vn_pap_revive_christian_communities.tt
                all_province = {
                    superregion = levant_superregion
                    religion = catholic
                }
            }
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 15 } 
        }
    }
    vn_pap_cradle_of_christianity = {
        icon = convert_the_holy_lands
        position = 10
        required_missions = { vn_pap_revive_christian_communities }
        provinces_to_highlight = {
            is_capital = yes
            owner = {
                capital_scope = {
                    superregion = mesopotamia_superregion
                }
                OR = {
                    religion = nestorian
                    religion = coptic
                    religion = monothelite
                }
            }
        }
        trigger = {
            OR = {
				custom_trigger_tooltip = {
					tooltip = vn_pap_cradle_of_christianity.tt
                    any_country = {
                        capital_scope = {
							superregion = mesopotamia_superregion
						}
                        OR = {
                            religion = nestorian
                            religion = coptic
                            religion = monothelite
                        }
                        has_opinion = {
							who = ROOT
							value = 100
						}
                    }
				}
                calc_true_if = {
                    amount = 10
                    all_province = {
                        superregion = mesopotamia_superregion
                        owner = { religion = catholic }
                    }
                    desc = vn_pap_cradle_of_christianity.ss
                }
			}
        }
        effect = {
            custom_tooltip = vn_pap_cradle_of_christianity.rr
            hidden_effect = {
                every_country = {
                    limit = {
                        NOT = { tag = ROOT }
                        capital_scope = {
							superregion = mesopotamia_superregion
						}
                        OR = {
                            religion = nestorian
                            religion = coptic
                            religion = monothelite
                        }
                    }
                    country_event = { id = flavor_pap.12 }
                }
            }
            add_country_modifier = {
                name = pap_cradle_of_christianity_mission
                duration = 9125
            }
        }
    }
    vn_pap_combat_heresy = {
        icon = crush_heretic_strongholds
        position = 11
        required_missions = { vn_pap_form_the_inquistion }
        provinces_to_highlight = {
            is_capital = yes
            owner = {
                religion_group = ROOT
                NOT = { religion = catholic }
                NOT = {
                    ROOT = {
                        has_won_war_against = {
                            who = PREV
                            max_years_since = 50
                        }
                    }
                }
            }
        }
        trigger = {
            calc_true_if = {
                amount = 5
                all_country = {
                    religion_group = ROOT
                    NOT = { religion = catholic }
                    ROOT = {
                        has_won_war_against = {
                            who = PREV
                            max_years_since = 50
                        }
                    }
                }
                desc = vn_pap_combat_heresy.tt
            }
        }
        effect = {
            add_country_modifier = {
                name = pap_combat_heresy_mission
                duration = 9125
            }
        }
    }
    vn_pap_pax_et_treuga_dei = {
        icon = peace_in_europe
        position = 12
        required_missions = { vn_pap_combat_heresy }
        provinces_to_highlight = {
            religion = catholic
            owner = { NOT = { religion = catholic } }
        }
        trigger = {
            if = {
                limit = { has_dlc = "Rights of Man" }
                is_great_power = yes
            }
            else = {
                num_of_cities = 250
            }
            if = {
                limit = { has_dlc = "Emperor" }
                is_defender_of_faith_of_tier = 5
            }
            else = {
                is_defender_of_faith = yes
            }
            custom_trigger_tooltip = {
                tooltip = vn_pap_pax_et_treuga_dei.tt
                NOT = {
                    any_province = {
                        religion = catholic
                        owner = { NOT = { religion = catholic } }
                    }
                }
            }
        }
        effect = {
            if = {
				limit = {
					has_dlc = "Cradle of Civilization"
					NOT = { army_professionalism = 0.90 }
				}
				add_army_professionalism = 0.1
			}
			else = {
				add_mil_power = 100
            }
            add_country_modifier = {
				name = "pap_universal_church"
				duration = 9125
			}
        }
	}
}

vn_pap_missions_slot_3 = {
    slot = 8
    generic = no
    ai = yes
    potential = {
        tag = PAP
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_pap_in_nomine_domini = {
        icon = sway_the_pope
        position = 1
        required_missions = { }
        trigger = {
			devotion = 90
            num_of_cardinals = 3
        }
        effect = {
            add_country_modifier = {
                name = pap_in_nomine_domini_mission
                duration = 9125
            }
        }
    }
    vn_pap_guelphs_and_ghibellines = {
        icon = the_italian_league
        position = 4
        required_missions = { vn_pap_in_nomine_domini }
        provinces_to_highlight = {
            if = {
                limit = { has_global_flag = guelph_ghib_enabled }
                owner = {
                    NOT = { tag = ROOT }
                    NOT = { alliance_with = ROOT }
                    has_ruler_modifier = guelph_ruler
                }
            }
            else = {
                always = no
            }
        }
        trigger = {
			custom_trigger_tooltip = {
				tooltip = vn_pap_guelphs_and_ghibellines.tt
				has_global_flag = guelph_ghib_enabled
            }
            OR = {
                calc_true_if = {
                    amount = 3
                    all_country = {
                        has_ruler_modifier = guelph_ruler
                        alliance_with = ROOT
                    }
                    desc = vn_pap_guelphs_and_ghibellines.ss
                }
                NOT = {
                    any_country = {
                        has_ruler_modifier = guelph_ruler
                    }
                }
            }
        }
        effect = {
            add_reform_progress_big_effect = yes
        }
    }
    vn_pap_guelphian_victory = {
        icon = centralized_empire
        position = 5
        required_missions = { vn_pap_guelphs_and_ghibellines }
        provinces_to_highlight = {
            is_capital = yes
            owner = {
                is_emperor = yes
            }
        }
        trigger = {
            OR = {
                NOT = { hre_size = 1 }
                war_score_against = {
                    who = emperor
                    value = 25
                }
            }
        }
        effect = {
            add_war_exhaustion = -2
            add_power_projection = {
                type = mission_rewards_power_projection
                amount = 20
            }
        }
    }
    vn_pap_conquer_egypt = {
        icon = mission_arabian_fort
        position = 9
        required_missions = { vn_pap_conquer_jerusalem }
        provinces_to_highlight = {
            OR = {
				area = bahari_area
				area = delta_area
				area = alexandria_area
				area = damietta_area
				area = vostani_area
				area = said_area
				area = red_sea_coast_area
            }
            NOT = { religion = catholic }
        }
        trigger = {
            calc_true_if = {
                amount = 25
                desc = vn_pap_conquer_egypt.tt
                all_province = {
                    OR = {
                        area = bahari_area
                        area = delta_area
                        area = alexandria_area
                        area = damietta_area
                        area = vostani_area
                        area = said_area
                        area = red_sea_coast_area
                    }
                    religion = catholic
                }
            }
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 15 } 
        }
    }
    vn_pap_conquer_tunis = {
        icon = crusader_fleet
        position = 10
        required_missions = { vn_pap_conquer_egypt vn_pap_revive_christian_communities }
        provinces_to_highlight = {
			OR = {
				area = tunis_area
				area = sousse_area
				area = mahdia_area
				area = djerba_area
                area = kef_area
                area = kairouan_area
                area = djerid_area
            }
            NOT = { religion = catholic }
        }
        trigger = {
            calc_true_if = {
                amount = 25
                desc = vn_pap_conquer_tunis.tt
                all_province = {
                    OR = {
                        area = tunis_area
                        area = sousse_area
                        area = mahdia_area
                        area = djerba_area
                area = kef_area
                area = kairouan_area
                area = djerid_area
                    }
                    religion = catholic
                }
            }
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 15 } 
        }
    }
    vn_pap_mission_to_the_mongols = {
        icon = mission_to_china
        position = 11
        required_missions = { vn_pap_cradle_of_christianity }
        trigger = {
            exists = ILK
            ILK = { NOT = { religion_group = christian } }
            reverse_has_opinion = {
                who = ILK
                value = 100
            }
        }
        effect = {
            ILK = {
                country_event = {
                    id = vn_missions.44
                }
            }
        }
    }
}

vn_pap_missions_slot_4 = {
    slot = 9
    generic = no
    ai = yes
    potential = {
        tag = PAP
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_pap_conquer_latium = {
        icon = republican_yearnings
        position = 1
        required_missions = {  }
        provinces_to_highlight = {
            owned_by = LZO
        }
        trigger = {
            LZO = {
                OR = {
                    exists = no
                    is_subject_of = ROOT
                }
            }
        }
        effect = {
            add_adm_power = 50
            spoleto_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
        }
    }
    vn_pap_conquer_spoleto = {
        icon = fund_the_monasteries
        position = 2
        required_missions = { vn_pap_conquer_latium }
        provinces_to_highlight = {
            area = spoleto_area
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            spoleto_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            urbino_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            ancona_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
        }
    }
    vn_pap_conquer_marche = {
        icon = dalmatian_conquest
        position = 3
        required_missions = { vn_pap_conquer_spoleto }
        provinces_to_highlight = {
            OR = {
                area = urbino_area
                area = ancona_area
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            urbino_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            ancona_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
			arezzo_area = {
                limit = {
                    NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
			}
			florence_area = {
                limit = {
                    NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
			}
			piombino_area = {
                limit = {
                    NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
			}
			siena_area = {
                limit = {
                    NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
			}
			scansano_area = {
                limit = {
                    NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
			}
			pisa_area = {
                limit = {
                    NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
			}
			lucca_area = {
                limit = {
                    NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
			}
			speza_area = {
                limit = {
                    NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
			}
            bologna_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            cesena_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
        }
    }
    vn_pap_conquer_tuscany = {
        icon = mission_arts_and_letters
        position = 4
        required_missions = { vn_pap_conquer_marche }
        provinces_to_highlight = {
			OR = {
				area = arezzo_area
				area = florence_area
				area = piombino_area
				area = siena_area
				area = scansano_area
				area = pisa_area
				area = lucca_area
				area = speza_area
			}
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
                value = 16
                OR = {
                    area = arezzo_area
                    area = florence_area
                    area = piombino_area
                    area = siena_area
                    area = scansano_area
                    area = pisa_area
                    area = lucca_area
                    area = speza_area
                }
            }
        }
        effect = {
			albenga_area = {
                limit = {
                    NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
			}
			savona_area = {
                limit = {
                    NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
			}
			genoa_area = {
                limit = {
                    NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
			}
			torino_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			aosta_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			monferrato_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			poirino_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			fossano_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			novara_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
        }
    }
    vn_pap_conquer_piedmont = {
        icon = unify_piedmont
        position = 5
        required_missions = { vn_pap_conquer_tuscany }
        provinces_to_highlight = {
			OR = {
				area = torino_area
				area = aosta_area
				area = monferrato_area
				area = poirino_area
				area = fossano_area
				area = novara_area
				area = albenga_area
				area = savona_area
				area = genoa_area
			}
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
                value = 24
                OR = {
                    area = torino_area
                    area = aosta_area
                    area = monferrato_area
                    area = poirino_area
                    area = fossano_area
                    area = novara_area
                    area = albenga_area
                    area = savona_area
                    area = genoa_area
                }
            }
        }
        effect = {
            add_adm_power = 50
            brescia_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            milan_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            como_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            bellinzona_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            pavia_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            modena_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            parma_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            mantua_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
        }
    }
    vn_pap_conquer_lombardy = {
        icon = seize_lombardy
        position = 6
        required_missions = { vn_pap_conquer_piedmont vn_pap_conquer_venetia }
        provinces_to_highlight = {
			OR = {
                area = brescia_area
                area = milan_area
                area = como_area
                area = bellinzona_area
                area = pavia_area
                area = modena_area
                area = parma_area
                area = mantua_area
			}
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
                value = 20
                OR = {
                    area = brescia_area
                    area = milan_area
                    area = como_area
                    area = bellinzona_area
                    area = pavia_area
                    area = modena_area
                    area = parma_area
                    area = mantua_area
                }
            }
        }
        effect = {
            add_power_projection = {
                type = mission_rewards_power_projection
                amount = 15
            }
            add_country_modifier = {
                name = pap_conquer_lombardy_mission
                duration = 9125
            }
        }
    }
    vn_pap_empire_of_the_allmighty = {
        icon = kingdom_of_heaven
        position = 7
        required_missions = { vn_pap_conquer_lombardy }
        trigger = {
            num_of_cities = 250
            has_reform = kingdom_of_god_reform
        }
        effect = {
            if = {
                limit = { is_absolutism_active = yes }
                add_absolutism = 10
            }
            else = {
                add_prestige_or_monarch_power = { amount = 10 } 
                add_devotion = 10
            }
            italy_superregion = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            add_country_modifier = {
                name = pap_empire_of_the_allmighty_mission
                duration = 36500
            }
        }
    }
    vn_pap_conquer_constantinople = {
        icon = the_latin_empire
        position = 8
        required_missions = { vn_pap_council_of_clermont }
        provinces_to_highlight = {
            province_id = 2233
        }
        trigger = {
            2233 = {
                owner = {
                    religion = catholic
                    is_subject = no
                }
            }
        }
        effect = {
            add_years_of_income = 0.5
            add_prestige_or_monarch_power = { amount = 15 } 
            2233 = {
                add_cardinal = yes
                owner = {
                    add_country_modifier = {
                        name = pap_conquer_constantinople_mission
                        duration = 9125
                    }
                }
            }
        }
    }
    vn_pap_heal_the_schism = {
        icon = take_constantinople
        position = 10
        required_missions = { vn_pap_conquer_egypt vn_pap_conquer_constantinople }
        provinces_to_highlight = {
			OR = {
				province_id = 2233	#Constaninople
				province_id = 2708	#Vatican
				province_id = 4974	#Jerusalem
				province_id = 5022	#Alexandria
				province_id = 3053	#Antioch
			}
            OR = {
                owner = {
                    NOT = { religion = catholic }
                }
            }
		}
		trigger = {
			2233 = {
				owner = {
                    religion = catholic
                }
			}
			2708 = {
				owner = {
                    religion = catholic
                }
			}
			4974 = {
				owner = {
                    religion = catholic
                }
			}
			5022 = {
				owner = {
                    religion = catholic
                }
			}
			3053 = {
				owner = {
                    religion = catholic
                }
			}
		}
        effect = {
            add_devotion = 10
            add_legitimacy = 10
            if = {
                limit = { has_dlc = "Emperor" }
                custom_tooltip = emp_pap_end_the_schism_tt
                hidden_effect = {
                    every_country = {
                        limit = { 
                            religion = orthodox 
                            knows_country = PAP
                        }
                        country_event = { id = flavor_pap.11 }
                    }
                }
            }
            2233 = { change_religion = catholic }
            2708 = { change_religion = catholic }
            4974 = { change_religion = catholic }
            5022 = { change_religion = catholic }
            3053 = { change_religion = catholic }
        }
    }
    vn_pap_establish_swiss_guard = {
        icon = form_the_swiss_guard
        position = 12
        required_missions = {  }
        trigger = {
            any_country = {
                primary_culture = swiss
                army_tradition = 50
                OR = {
                    alliance_with = ROOT
                    has_opinion = {
                        who = ROOT
                        value = 125
                    }
                }
            }
        }
        effect = {
            if = {
                limit = { has_dlc = "Emperor" }
                set_country_flag = pap_swiss_guard_mission_flag
                custom_tooltip = emp_pap_swiss_guard_mercs_enabled
                country_event = { id = papacy_events.1 }
            }
            add_army_tradition = 15
            add_mil_power = 25
        }
	}
}

vn_pap_missions_slot_5 = {
    slot = 10
    generic = no
    ai = yes
    potential = {
        tag = PAP
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_pap_papal_treasuries = {
        icon = mission_african_gold
        position = 1
        required_missions = {  }
        trigger = {
            if = {
				limit = {
					has_dlc = "Emperor"
				}
				curia_treasury_size = 2500
			}
            treasury = 500
            is_in_deficit = no
            NOT = { num_of_loans = 1 }
        }
        effect = {
            add_inflation = -1
        }
    }
    vn_pap_catholic_splendour = {
        icon = italian_riches
        position = 2
        required_missions = { vn_pap_papal_treasuries }
        trigger = {
			if = {
				limit = { has_dlc = "Mandate of Heaven" }
				OR = {
					in_golden_age = yes
					has_had_golden_age = yes
				}
            }
            stability = 3
            is_at_war = no
        }
        effect = {
            add_years_of_income = 1
            add_estate_nobles_loyalty_effect = yes
            add_estate_church_loyalty_effect = yes
            add_estate_burghers_loyalty_effect = yes
        }
    }
    vn_pap_conquer_ferrara = {
        icon = secure_the_republic
        position = 4
        required_missions = { vn_pap_conquer_marche }
        provinces_to_highlight = {
            OR = {
                area = bologna_area
                area = cesena_area
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
                value = 12
                OR = {
                    area = bologna_area
                    area = cesena_area
                }
            }
        }
        effect = {
            venice_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            bassano_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            verona_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            padua_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            friuli_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            tolmezzo_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            belluno_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
        }
    }
    vn_pap_conquer_venetia = {
        icon = mission_control_venice
        position = 5
        required_missions = { vn_pap_conquer_ferrara }
        provinces_to_highlight = {
            OR = {
                area = venice_area
                area = bassano_area
                area = verona_area
                area = padua_area
                area = friuli_area
                area = tolmezzo_area
                area = belluno_area
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
                value = 16
                OR = {
                    area = venice_area
                    area = bassano_area
                    area = verona_area
                    area = padua_area
                    area = friuli_area
                    area = tolmezzo_area
                    area = belluno_area
                }
            }
        }
        effect = {
            add_navy_tradition = 20
        }
    }
    vn_pap_a_courteous_gift = {
        icon = negotiate_for_avignon
        position = 6
        required_missions = {  }
        completed_by = 1309.3.9
        provinces_to_highlight = {
            province_id = 202
            OR = {
                NOT = { owned_by = ROOT }
                NOT = { is_core = ROOT }
            }
        }
        trigger = {
            owns_core_province = 202
        }
        effect = {
            202 = {
                add_base_tax = 1
                add_base_production = 1
                add_base_manpower = 1
                add_province_modifier = {
                    name = pap_a_courteous_gift_mission
                    duration = 9125
                }
            }
        }
    }
    vn_pap_babylonian_captivity = {
        icon = sway_the_pope
        position = 7
        required_missions = { vn_pap_a_courteous_gift }
        completed_by = 1378.9.20
        trigger = {
            is_religion_enabled = catholique
            custom_trigger_tooltip = {
                tooltip = vn_pap_babylonian_captivity.tt
                had_global_flag = {
                    flag = western_schism_flag
                    days = 3650
                }
            }
            monthly_dip = 12
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 5 } 
            add_dip_power = 50
            if = {
                limit = {
                    AVI = {
                        exists = yes
                        is_subject_other_than_tributary_trigger = yes
                        religion = catholique
                        has_reform = papacy_reform
                    }
                }
                add_casus_belli = {
                    type = cb_vassalize_mission
                    target = AVI
                    months = 9125
                }
            }
            else = {
                202 = {
                    add_permanent_claim = ROOT
                }
            }
        }
    }
    vn_pap_end_anti_papacy = {
        icon = spread_piety
        position = 8
        required_missions = { vn_pap_babylonian_captivity }
        trigger = {
            202 = { country_or_non_sovereign_subject_holds = ROOT }
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 25 } 
            custom_tooltip = vn_pap_end_anti_papacy.tt
            hidden_effect = {
                every_country = {
                    limit = { religion = catholique }
                    add_prestige = -10
                    add_papal_influence = -10
                }
            }
        }
    }
    vn_pap_the_city_of_god = {
        icon = develop_our_capital
        position = 9
        required_missions = {  }
        provinces_to_highlight = {
            province_id = 2708
        }
        trigger = {
            2708 = {
                owned_by = ROOT
                num_of_times_improved_by_owner = 10
                num_of_buildings_in_province = 4
            }
        }
        effect = {
            custom_tooltip = vedic_education_tt
			hidden_effect = {
				if = {
					limit = {
						OR = {
                            AND = {
                                is_institution_enabled = feudalism
								NOT = { has_institution = feudalism }
                            }
							AND = {
								is_institution_enabled = renaissance
								NOT = { has_institution = renaissance }
							}
							AND = {
								is_institution_enabled = new_world_i
								NOT = { has_institution = new_world_i }
							}
							AND = {
								is_institution_enabled = printing_press
								NOT = { has_institution = printing_press }
							}
							AND = {
								is_institution_enabled = printing_press
								NOT = { has_institution = printing_press }
							}
							AND = {
								is_institution_enabled = global_trade
								NOT = { has_institution = global_trade }
							}
							AND = {
								is_institution_enabled = manufactories
								NOT = { has_institution = manufactories }
							}
							AND = {
								is_institution_enabled = enlightenment
								NOT = { has_institution = enlightenment }
							}
                            AND = {
                                is_institution_enabled = industrialization
								NOT = { has_institution = industrialization }
                            }
						}
					}
					capital_scope = {
						area = {
							add_next_institution_embracement = 25
						}
					}
				}
			}
            define_advisor = {
                type = theologian
                skill = 3
                cost_multiplier = 0.25
            }
        }
    }
    vn_pap_catholic_scholasticism = {
        icon = mission_rb_the_education_acts
        position = 10
        required_missions = { vn_pap_the_city_of_god }
        trigger = {
			num_of_owned_provinces_with = {
				value = 5
				has_education_building_trigger = yes
                has_tax_building_trigger = yes
			}	
        }
        effect = {
            add_innovativeness_big_effect = yes
            add_country_modifier = {
                name = pap_catholic_scholasticism_mission
                duration = 9125
            }
        }
    }
    vn_pap_the_vatican_library = {
        icon = found_the_vatican_library
        position = 12
        required_missions = { vn_pap_catholic_scholasticism }
        provinces_to_highlight = {
            province_id = 2708
            OR = {
                NOT = { owned_by = ROOT }
                NOT = { has_education_building_trigger = yes }
                devastation = 1
                unrest = 1
            }
        }
        trigger = {
            monthly_adm = 10
            2708 = {
                owned_by = ROOT
                has_education_building_trigger = yes
                NOT = { devastation = 1 }
                NOT = { unrest = 1 }
            }
        }
        effect = {
            if = {
				limit = { has_dlc = "Emperor" NOT = { has_country_flag = vatican_library_mission_flag } }
				set_country_flag = vatican_library_mission_flag
                country_event = {
                    id = papacy_events.11
                }
            }
			else = {
                random_list = {
                    33 = { add_adm_power = 50 }
                    33 = { add_dip_power = 50 }
                    33 = { add_mil_power = 50 }
                }
				add_prestige_or_monarch_power = { amount = 10 } 
			}
        }
    }
    vn_pap_sistine_chapel = {
        icon = new_st_peters_basilica
        position = 13
        required_missions = { vn_pap_the_vatican_library vn_pap_establish_swiss_guard }
        provinces_to_highlight = {
            province_id = 2708
            OR = {
                NOT = { owned_by = ROOT }
                NOT = { has_building = cathedral }
                devastation = 1
                unrest = 1
            }
        }
        trigger = {
            monthly_income = 50
            2708 = {
                owned_by = ROOT
                has_building = cathedral
                NOT = { devastation = 1 }
                NOT = { unrest = 1 }
            }
        }
        effect = {
            add_devotion = 10
            add_legitimacy = 10
            custom_tooltip = vn_pap_sistine_chapel.tt
            hidden_effect = {
                every_owned_province = {
                    limit = { has_building = cathedral }
                    add_province_modifier = {
                        name = pap_sistine_chapel_mission
                        duration = 9125
                    }
                }
            }
        }
    }
    vn_pap_apostolic_authority = {
        icon = a_place_among_the_great_powers
        position = 14
        required_missions = { vn_pap_sistine_chapel }
        trigger = {
            has_completed_all_reforms_trigger = yes
            absolutism = 50
        }
        effect = {
            add_stability_or_adm_power = yes
            add_adm_power = 100
			add_dip_power = 100
			add_mil_power = 100
            add_country_modifier = {
                name = pap_apostolic_authority_mission
                duration = -1
            }
        }
	}	
}