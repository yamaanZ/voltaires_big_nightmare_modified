#Portucale/Portugal Missions
#by Isildur

vn_por_missions_slot_1_a = {
    slot = 6
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = PCA
            OR = {
				tag = POR
				AND = {
					tag = SPA
					was_tag = POR
				}
			}
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_por_found_portuguese_navy = {
        icon = mission_aragonese_navy
        required_missions = { }
        position = 1
        trigger = {
            naval_forcelimit = 30
			calc_true_if = {
				num_of_heavy_ship = 5
				num_of_galley = 10
				num_of_light_ship = 10
				num_of_transport = 15
				amount = 3
			}
        }
        effect = {
			add_navy_tradition = 10
            add_country_modifier = {
                name = "por_found_portuguese_navy_mission"
                duration = 9125
            }
        }
    }
    vn_por_prosperous_ports = {
        icon = mission_great_trading_houses
        required_missions = { vn_por_found_portuguese_navy }
        position = 3
        trigger = {
            num_of_owned_provinces_with = {
                value = 5
				has_port = yes
				OR = {
					AND = {
						development = 10
                		has_dock_building_trigger = yes
					}
					AND = {
						development = 15
						has_building = harbour
					}
				}
            }
        }
        effect = {
            custom_tooltip = vn_will_receive_rewards_tt
            random_owned_province = {
                limit = { 
                    has_port = yes
                    OR = {
						AND = {
							development = 10
							has_dock_building_trigger = yes
						}
						AND = {
							development = 15
							has_building = harbour
						}
					}
                }
                add_province_modifier = {
                    name = "por_prosperous_ports_mission"
                    duration = 9125
                }
			}
			random_owned_province = {
                limit = { 
                    has_port = yes
                    OR = {
						AND = {
							development = 10
							has_dock_building_trigger = yes
						}
						AND = {
							development = 15
							has_building = harbour
						}
					}
					NOT = { has_province_modifier = por_prosperous_ports_mission }
                }
                add_province_modifier = {
                    name = "por_prosperous_ports_mission"
                    duration = 9125
                }
			}
        }
    }
    vn_por_advanced_shipbuilding = {
        icon = mission_launch_a_flagship
        required_missions = { vn_por_prosperous_ports }
        trigger = {
			num_of_heavy_ship = 10
			num_of_owned_provinces_with = {
				value = 5
				has_shipyard_building_trigger = yes
			}
        }
        effect = {
            define_advisor = {
                type = naval_reformer
                skill = 2
                discount = yes
            }
            add_country_modifier = {
                name = "por_advanced_shipbuilding_mission"
                duration = 9125
            }
        }
	}
	vn_por_land_in_madeira = {
        icon = mission_invade_island
        required_missions = { }
        completed_by = 1425.1.1
		provinces_to_highlight = {
			province_id = 5115
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
			5115 = { country_or_non_sovereign_subject_holds = ROOT }
        }
        effect = {
            5115 = {
				add_base_production = 2
			}
			add_country_modifier = {
				name = "por_land_in_madeira_mission"
				duration = 7300
			}
			5113 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT
				}
			}
			5112 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT
				}
			}
			5111 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT
				}
			}
			5110 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT
				}
			}
			5109 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT
				}
			}
			5108 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT
				}
			}
			5107 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT
				}
			}
        }
    }
	vn_por_toward_canaries = {
        icon = mission_claim_the_canaries
        required_missions = { vn_por_land_in_madeira }
        provinces_to_highlight = {
            OR = {
				province_id = 5113
				province_id = 5112
				province_id = 5111
				province_id = 5110
				province_id = 5109
				province_id = 5108
				province_id = 5107
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
			5113 = { country_or_non_sovereign_subject_holds = ROOT }
			5112 = { country_or_non_sovereign_subject_holds = ROOT }
			5111 = { country_or_non_sovereign_subject_holds = ROOT }
			5110 = { country_or_non_sovereign_subject_holds = ROOT }
			5109 = { country_or_non_sovereign_subject_holds = ROOT }
			5108 = { country_or_non_sovereign_subject_holds = ROOT }
			5107 = { country_or_non_sovereign_subject_holds = ROOT }
        }
        effect = {
            5110 = {
				add_base_tax = 1
				add_base_production = 1
				add_base_manpower = 1
			}
        }
	}
	vn_por_control_moroccan_trade = {
		icon = mission_sponsor_piracy
		position = 8
        required_missions = { 
			vn_por_toward_canaries
			vn_por_moroccan_ports 
		}
        trigger = {
			4749 = {
				is_strongest_trade_power = ROOT
			}
			4656 = {
				is_strongest_trade_power = ROOT
			}
        }
        effect = {
			add_years_of_income = 0.25
			4749 = {
				add_trade_modifier = {
					power = 10
					duration = 9125
					key = por_control_moroccan_trade_mission
					who = ROOT
				}
			}
            4656 = {
				add_trade_modifier = {
					power = 10
					duration = 9125
					key = por_control_moroccan_trade_mission
					who = ROOT
				}
			}
        }
    }
}

vn_por_missions_slot_2_a = {
    slot = 7
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = PCA
            OR = {
				tag = POR
				AND = {
					tag = SPA
					was_tag = POR
				}
			}
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_por_douro_trade = {
        icon = mission_wine_monopolies
        required_missions = { }
        position = 1
        trigger = {
            any_owned_province = {
                OR = {
                    area = porto_area
                    area = braganca_area
                }
                OR = {
                    province_has_center_of_trade_of_level = 2
                    has_trade_building_trigger = yes
                } 
            }
        }
        effect = {
			custom_tooltip = vn_por_douro_trade.tt
			hidden_effect = {
				porto_area = {
					limit = {
						owned_by = ROOT
						trade_goods = wine
					}
					add_province_modifier = {
						name = "por_douro_trade_mission"
						duration = 9125
					}
				}
				braganca_area = {
					limit = {
						owned_by = ROOT
						trade_goods = wine
					}
					add_province_modifier = {
						name = "por_douro_trade_mission"
						duration = 9125
					}
				}
			}
        }
    }
    vn_por_exotic_trade_goods = {
        icon = mission_rb_colonise_spice_islands
        required_missions = { vn_por_douro_trade }
        trigger = {
            peaches = 5
			olive = 3
			rice = 3
			hemp = 3
			spices = 3
            any_owned_province = {
                OR = {
                    trade_goods = peaches
					trade_goods = olive
					trade_goods = rice
					trade_goods = hemp
					trade_goods = spices
                }
                has_trade_building_trigger = yes
            }
        }
        effect = {
            custom_tooltip = vn_will_receive_rewards_tt
            random_owned_province = {
                limit = {
                    OR = {
                        trade_goods = peaches
						trade_goods = olive
						trade_goods = rice
						trade_goods = hemp
						trade_goods = spices
                    }
                    has_trade_building_trigger = yes
				}
				add_base_production = 2
                add_province_modifier = {
                    name = "por_exotic_trade_goods_mission"
                    duration = 9125
                }
            }
            random_owned_province = {
                limit = {
                    NOT = {
                        OR = {
                            trade_goods = peaches
                            trade_goods = olive
                            trade_goods = rice
							trade_goods = hemp
							trade_goods = spices
                        }
                    }
				}
				add_base_production = 2
                random_list = {
                    20 = {
                        change_trade_goods = peaches
                    }
                    20 = {
                        change_trade_goods = olive
                    }
                    20 = {
                        change_trade_goods = rice
					}
					20 = {
                        change_trade_goods = hemp
					}
					20 = {
                        change_trade_goods = spices
                    }
                }
            }
        }
    }
    vn_por_monopoly_in_iberia = {
        icon = mission_dominate_home_trade_node
        required_missions = { 
            vn_por_exotic_trade_goods
            vn_por_prosperous_ports
        }
        position = 4
        trigger = {
            1135 = {
                is_strongest_trade_power = ROOT
			}
			740 = {
                is_strongest_trade_power = ROOT
			}
			2160 = {
                is_strongest_trade_power = ROOT
            }
            1208 = {
                is_strongest_trade_power = ROOT
            }
            1867 = {
                is_strongest_trade_power = ROOT
            }
            1955 = {
                is_strongest_trade_power = ROOT
            }
        }
        effect = {
            add_power_projection = {
                type = mission_rewards_power_projection
                amount = 25
            }
            add_years_of_income = 0.5
            add_country_modifier = {
                name = "por_monopoly_in_iberia_mission"
                duration = 7300
            }
        }
	}
}

vn_por_missions_slot_2_b = {
    slot = 7
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = PCA
            OR = {
				tag = POR
				AND = {
					tag = SPA
					was_tag = POR
				}
			}
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_por_repopulate_territories = {
        icon = mission_colonial
        required_missions = { vn_por_seize_algarve }
        position = 6
        trigger = {
            num_of_owned_provinces_with = {
				value = 10
                OR = {
                    area = porto_area
                    area = braganca_area
                    area = coimbra_area
                    area = algarve_area
                    area = alentejo_area
                    area = avis_area
                    area = lisboa_area
				}
                development = 10
            }
            num_of_owned_provinces_with = {
				value = 5
                OR = {
                    area = porto_area
                    area = braganca_area
                    area = coimbra_area
                    area = algarve_area
                    area = alentejo_area
                    area = avis_area
                    area = lisboa_area
				}
                development = 15
            }
        }
        effect = {
            custom_tooltip = vn_will_receive_rewards_tt
            random_owned_province = {
                limit = {
                    NOT = { has_fort_trigger = yes }
                }
				add_building = fort_14th
				add_base_manpower = 2
            }
            random_owned_province = {
                limit = {
                    NOT = { development = 10 }
                }
                add_base_tax = 1
                add_base_production = 1
                add_base_manpower = 1
            }
        }
    }
    vn_por_deal_with_moors = {
        icon = mission_establish_jesuit_missions
        required_missions = { vn_por_repopulate_territories }
        trigger = {
            OR = {
                AND = {
                    full_idea_group = humanist_ideas
                    NOT = { full_idea_group = religious_ideas }
                }
                AND = {
                    full_idea_group = religious_ideas
                    NOT = { full_idea_group = humanist_ideas }
                }
            }
            religious_unity = 1
        }
        effect = {
            custom_tooltip = vn_por_deal_with_moors.tt
            if = {
                limit = {
                    full_idea_group = humanist_ideas
                    NOT = { full_idea_group = religious_ideas }
                }
                add_country_modifier = {
                    name = "por_deal_with_moors_mission"
                    duration = 9125
                }
            }
            if = {
                limit = {
                    full_idea_group = religious_ideas
                    NOT = { full_idea_group = humanist_ideas }
                }
                add_country_modifier = {
                    name = "por_deal_with_moors_mission2"
                    duration = 9125
                }
            }
        }
	}
	vn_por_dominate_maghreb = {
        icon = mission_control_the_barbary_coast
        required_missions = { 
			vn_por_control_moroccan_trade 
			vn_por_establish_feitorias
		}
		position = 9
        provinces_to_highlight = {
			superregion = maghreb_superregion
			has_port = yes
			NOT = { development = 15 }
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
			num_of_owned_provinces_with = {
				value = 10
				development = 15
				has_port = yes
				superregion = maghreb_superregion
			}
        }
        effect = {
			add_adm_power = 50
			tunis_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			sousse_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			mahdia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			djerba_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			oran_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			saida_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			bejaia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			constantine_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
        }
	}
}

vn_por_missions_slot_3_a = {
    slot = 8
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = PCA
            OR = {
				tag = POR
				AND = {
					tag = SPA
					was_tag = POR
				}
			}
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_por_levy_crusaders = {
        icon = mission_crusade_for_varna
        required_missions = { }
        completed_by = 1055.1.1
        position = 1
        trigger = {
            army_size_percentage = 0.75
            num_of_generals = 1
            NOT = {
				any_owned_province = {
					controlled_by = REB
				}
			}
			custom_trigger_tooltip = {
				tooltip = vn_ara_prepare_reconquista.tt
				any_neighbor_country = {
					religion = sunni
				}
			}
        }
        effect = {
			add_army_tradition = 10
			porto_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			braganca_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            coimbra_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            galicia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            ourense_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
        }
    }
    vn_por_beyond_douro = {
        icon = mission_advance_to_the_dnieper
        required_missions = { vn_por_levy_crusaders }
        completed_by = 1146.1.1
        provinces_to_highlight = {
			area = coimbra_area
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            coimbra_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            add_adm_power = 50
            lisboa_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
        }
    }
    vn_por_university_of_coimbra = {
        icon = mission_early_modern_university
		required_missions = { vn_por_beyond_douro }
		provinces_to_highlight = {
			province_id = 2243
        }
        completed_by = 1290.1.1
        trigger = {
            2243 = {
                owned_by = ROOT
                is_core = ROOT
                culture = ROOT
                religion = ROOT
                has_education_building_trigger = yes
                development = 15
            }
        }
        effect = {
            2243 = {
                add_province_modifier = {
                    name = "por_university_of_coimbra_mission"
                    duration = -1
                }
            }
        }
    }
}

vn_por_missions_slot_3_b = {
    slot = 8
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = PCA
            OR = {
				tag = POR
				AND = {
					tag = SPA
					was_tag = POR
				}
			}
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_por_conquer_alentejo = {
        icon = mission_crusade_for_varna
        required_missions = { vn_por_gates_of_lisbon }
        position = 4
        completed_by = 1238.1.1
        provinces_to_highlight = {
            OR = {
				area = avis_area
				area = alentejo_area
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            avis_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            alentejo_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 10 } 
            algarve_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
        }
    }
    vn_por_seize_algarve = {
        icon = mission_portuguese_interference
        required_missions = { vn_por_conquer_alentejo }
        completed_by = 1249.1.1
        provinces_to_highlight = {
            area = algarve_area
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            algarve_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            4467 = {
                add_province_modifier = {
                    name = "por_seize_algarve_mission"
                    duration = 18250
                }
            }
        }
	}
	vn_por_claim_ceuta = {
        icon = mission_retake_ceuta
        required_missions = { vn_por_seize_algarve }
        completed_by = 1415.8.21
        provinces_to_highlight = {
			province_id = 4626
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
			4626 = { country_or_non_sovereign_subject_holds = ROOT }
        }
        effect = {
			4626 = {
				if = {
					limit = {
						NOT = { has_building = fort_14th }
						num_free_building_slots = 1
					}
					add_building = fort_14th
				}
			}
            tangiers_area = {
				limit = {
					has_port = yes
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
            tetouan_area = {
				limit = {
					has_port = yes
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
            melilla_area = {
				limit = {
					has_port = yes
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
            oujda_area = {
				limit = {
					has_port = yes
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
            safi_area = {
				limit = {
					has_port = yes
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
            jadida_area = {
				limit = {
					has_port = yes
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
            rabat_area = {
				limit = {
					has_port = yes
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			taroudant_area = {
				limit = {
					has_port = yes
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			guelmim_area = {
				limit = {
					has_port = yes
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
        }
	}
	vn_por_moroccan_ports = {
        icon = mission_moroccan_ports
        required_missions = { vn_por_claim_ceuta }
        provinces_to_highlight = {
            OR = {
                area = tangiers_area
                area = tetouan_area
                area = melilla_area
                area = oujda_area
                area = safi_area
                area = jadida_area
                area = rabat_area
				area = taroudant_area
				area = guelmim_area
			}
			has_port = yes
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
			4626 = { country_or_non_sovereign_subject_holds = ROOT }
			4625 = { country_or_non_sovereign_subject_holds = ROOT }
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 20
				has_port = yes
                OR = {
                    area = tangiers_area
                    area = tetouan_area
                    area = melilla_area
                    area = oujda_area
                    area = safi_area
                    area = jadida_area
                    area = rabat_area
					area = taroudant_area
					area = guelmim_area
				}
			}
        }
        effect = {
            tangiers_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
            tetouan_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
            melilla_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
            oujda_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
            safi_area = {
                limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            jadida_area = {
                limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            rabat_area = {
                limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            macaronesia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
            guelmim_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
            draa_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
            taroudant_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
            marrakesh_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
            khouribga_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
            tadla_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
            meknes_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
            fez_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
            debdou_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
        }
	}
	vn_por_establish_feitorias = {
        icon = mission_portuguese_oman
        required_missions = { vn_por_moroccan_ports }
		position = 8
        trigger = {
			num_of_owned_provinces_with = {
				value = 10
				continent = africa
				has_trade_building_trigger = yes
				province_has_center_of_trade_of_level = 1
			}
        }
        effect = {
            custom_tooltip = vn_will_receive_rewards_tt
            random_owned_province = {
				limit = {
					continent = africa
					has_trade_building_trigger = yes
					province_has_center_of_trade_of_level = 1
				}
				add_base_production = 2
				add_province_modifier = {
					name = "por_establish_feitorias_mission"
					duration = 9125
				}
			}
        }
    }
}

vn_por_missions_slot_4_a = {
    slot = 9
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = PCA
            OR = {
				tag = POR
				AND = {
					tag = SPA
					was_tag = POR
				}
			}
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_por_conquest_of_galicia = {
        icon = mission_cannons_firing
        required_missions = { 
            vn_por_levy_crusaders
            vn_por_achieve_independence
        }
        position = 2
        provinces_to_highlight = {
            OR = {
                area = galicia_area
                area = ourense_area
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            galicia_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            ourense_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
			add_dip_power = 50
            galicia_area = {
                limit = { country_or_non_sovereign_subject_holds = ROOT }
                add_province_modifier = {
                    name = "por_conquest_of_galicia_mission"
                    duration = 9125
                }
            }
            ourense_area = {
                limit = { country_or_non_sovereign_subject_holds = ROOT }
                add_province_modifier = {
                    name = "por_conquest_of_galicia_mission"
                    duration = 9125
                }
            }
        }
    }
}

vn_por_missions_slot_4_b = {
    slot = 9
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = PCA
            OR = {
				tag = POR
				AND = {
					tag = SPA
					was_tag = POR
				}
			}
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_por_gates_of_lisbon = {
        icon = mission_tear_down_spanish_strongholds
        required_missions = { vn_por_beyond_douro }
        completed_by = 1165.1.1
        position = 3
        provinces_to_highlight = {
            area = lisboa_area
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            lisboa_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
			add_legitimacy = 10
			1135 = {
				add_nationalism = -5
			}
            avis_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            alentejo_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
        }
    }
    vn_por_a_new_capital = {
        icon = mission_guilds_of_barcelona
        required_missions = { vn_por_gates_of_lisbon }
        completed_by = 1255.1.1
        provinces_to_highlight = {
            province_id = 1135
        }
        trigger = {
            capital = 1135
            1135 = {
                owned_by = ROOT
                is_core = ROOT
                development = 20
            }
        }
        effect = {
            1135 = {
                add_base_tax = 1
                add_base_production = 1
                add_base_manpower = 1
                add_province_modifier = {
                    name = "por_a_new_capital_mission"
                    duration = 9125
                }
            }
        }
    }
}

vn_por_missions_slot_4_c = {
    slot = 9
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = PCA
            OR = {
				tag = POR
				AND = {
					tag = SPA
					was_tag = POR
				}
			}
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

	vn_por_portuguese_cortes = {
        icon = mission_noble_council
        required_missions = {
			vn_por_a_new_capital
			vn_por_kingdom_of_portugal
		}
        position = 5
        provinces_to_highlight = {
			OR = {
				area = porto_area
				area = braganca_area
				area = coimbra_area
                area = algarve_area
                area = alentejo_area
                area = avis_area
                area = lisboa_area
            }
            OR = {
                NOT = { owned_by = ROOT }
                NOT = { is_core = ROOT }
                consolidated_region_trigger = no
            }
        }
        trigger = {
            if = {
				limit = { has_estate = estate_nobles }
				estate_loyalty = {
					estate = estate_nobles
					loyalty = 60
				}
			}
			else = {
				has_mil_advisor_2 = yes
			}
			if = {
				limit = { has_estate = estate_church }
				estate_loyalty = {
					estate = estate_church
					loyalty = 60
				}
			}
			else = {
				has_adm_advisor_2 = yes
			}
			if = {
				limit = { has_estate = estate_burghers }
				estate_loyalty = {
					estate = estate_burghers
					loyalty = 60
				}
			}
			else = {
				has_dip_advisor_2 = yes
			}
			porto_area = {
				type = all
				owned_by = ROOT
				is_core = ROOT
				consolidated_region_trigger = yes
			}
			braganca_area = {
				type = all
				owned_by = ROOT
				is_core = ROOT
				consolidated_region_trigger = yes
			}
			coimbra_area = {
				type = all
				owned_by = ROOT
				is_core = ROOT
				consolidated_region_trigger = yes
			}
            algarve_area = {
				type = all
				owned_by = ROOT
				is_core = ROOT
				consolidated_region_trigger = yes
			}
            alentejo_area = {
				type = all
				owned_by = ROOT
				is_core = ROOT
				consolidated_region_trigger = yes
			}
            avis_area = {
				type = all
				owned_by = ROOT
				is_core = ROOT
				consolidated_region_trigger = yes
			}
            lisboa_area = {
				type = all
				owned_by = ROOT
				is_core = ROOT
				consolidated_region_trigger = yes
			}
        }
        effect = {
            2264 = {
				add_base_tax = 1
				add_province_modifier = {
					name = "por_portuguese_cortes_mission"
					duration = -1
				}
			}
			1126 = {
				add_base_tax = 1
				add_province_modifier = {
					name = "por_portuguese_cortes_mission"
					duration = -1
				}
			}
			2265 = {
				add_base_tax = 1
				add_province_modifier = {
					name = "por_portuguese_cortes_mission"
					duration = -1
				}
			}
			2243 = {
				add_base_tax = 1
				add_province_modifier = {
					name = "por_portuguese_cortes_mission"
					duration = -1
				}
			}
			4446 = {
				add_base_tax = 1
				add_province_modifier = {
					name = "por_portuguese_cortes_mission"
					duration = -1
				}
			}
        }
    }
    vn_por_portuguese_renaissance = {
        icon = mission_arts_and_letters
        required_missions = { }
        position = 6
        completed_by = 1450.1.1
        trigger = {
            has_institution = renaissance
			all_state_province = {
				renaissance = 100
			}
        }
        effect = {
			add_years_of_income = 0.5
            define_advisor = {
                type = artist
                culture = portugese
                skill = 3
                cost_multiplier = 0.25
            }
        }
    }
}

vn_por_missions_slot_4_d = {
    slot = 9
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = PCA
            OR = {
				tag = POR
				AND = {
					tag = SPA
					was_tag = POR
				}
			}
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_por_castilian_diplomacy = {
        icon = mission_castillian_aggression
        required_missions = { vn_por_papal_relations }
        position = 7
        trigger = {
            government_rank = 5
            is_subject = no
            tag = POR
            if = {
                limit = { exists = CAS }
                CAS = {
                    OR = {
                        OR = {
                            has_opinion = {
                                who = ROOT
                                value = 125
                            }
                            OR = {
                                marriage_with = ROOT
                                alliance_with = ROOT
                            }
                        }
                        OR = {
                            is_enemy = ROOT
                            is_rival = ROOT
                            NOT = {
                                has_opinion = {
                                    who = ROOT
                                    value = -125
                                }
                            }
                        }
                    }
                }
            }
            else = {
                any_known_country = {
                    primary_culture = castillian
                    OR = {
                        OR = {
                            has_opinion = {
                                who = ROOT
                                value = 125
                            }
                            OR = {
                                marriage_with = ROOT
                                alliance_with = ROOT
                            }
                        }
                        OR = {
                            is_enemy = ROOT
                            is_rival = ROOT
                            NOT = {
                                has_opinion = {
                                    who = ROOT
                                    value = -125
                                }
                            }
                        }
                    }
                }
            }
        }
        effect = {
            add_country_modifier = {
                name = "por_castilian_diplomacy_mission"
                duration = 9125
            }
        }
    }
}

vn_por_missions_slot_5_a = {
    slot = 10
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = PCA
            OR = {
				tag = POR
				AND = {
					tag = SPA
					was_tag = POR
				}
			}
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_por_achieve_independence = {
        icon = mission_soldiers_in_line
        required_missions = { }
        completed_by = 1096.1.1
        position = 1
        trigger = {
			is_subject = no
			num_of_allies = 2
        }
        effect = {
            add_legitimacy = 10
            porto_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            braganca_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            add_country_modifier = {
                name = "por_achieve_independence_mission"
                duration = 9125
            }
        }
    }
    vn_por_kingdom_of_portugal = {
        icon = mission_union_with_portugal
        required_missions = {
            vn_por_gates_of_lisbon
            vn_por_achieve_independence
        }
        position = 4
        completed_by = 1147.10.25
        trigger = {
            government_rank = 5
            is_subject = no
            tag = POR
            owns_core_province = 1234
            owns_core_province = 2243
            owns_core_province = 1135
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 10 } 
            add_country_modifier = {
                name = "por_kingdom_of_portugal_mission"
                duration = -1
            }
			porto_area = {
                limit = {
                    owned_by = ROOT
                    NOT = { culture = portugese }
                }
                add_province_modifier = {
                    name = "por_kingdom_of_portugal_mission2"
                    duration = 9125
                }
            }
			braganca_area = {
                limit = {
                    owned_by = ROOT
                    NOT = { culture = portugese }
                }
                add_province_modifier = {
                    name = "por_kingdom_of_portugal_mission2"
                    duration = 9125
                }
            }
			coimbra_area = {
                limit = {
                    owned_by = ROOT
                    NOT = { culture = portugese }
                }
                add_province_modifier = {
                    name = "por_kingdom_of_portugal_mission2"
                    duration = 9125
                }
            }
            algarve_area = {
                limit = {
                    owned_by = ROOT
                    NOT = { culture = portugese }
                }
                add_province_modifier = {
                    name = "por_kingdom_of_portugal_mission2"
                    duration = 9125
                }
            }
            alentejo_area = {
                limit = {
                    owned_by = ROOT
                    NOT = { culture = portugese }
                }
                add_province_modifier = {
                    name = "por_kingdom_of_portugal_mission2"
                    duration = 9125
                }
            }
            avis_area = {
                limit = {
                    owned_by = ROOT
                    NOT = { culture = portugese }
                }
                add_province_modifier = {
                    name = "por_kingdom_of_portugal_mission2"
                    duration = 9125
                }
            }
            lisboa_area = {
                limit = {
                    owned_by = ROOT
                    NOT = { culture = portugese }
                }
                add_province_modifier = {
                    name = "por_kingdom_of_portugal_mission2"
                    duration = 9125
                }
            }
        }
    }
    vn_por_papal_relations = {
        icon = mission_religious
        required_missions = { vn_por_kingdom_of_portugal }
        position = 6
        completed_by = 1179.5.23
        trigger = {
            government_rank = 5
            is_subject = no
            tag = POR
            religion_group = christian
            uses_papacy = yes
            reverse_has_opinion = {
                who = PAP
                value = 100
            }
        }
        effect = {
            country_event = {
                id = vn_missions.77
            }
        }
    }
    vn_por_alliance_with_england = {
        icon = mission_rb_invade_england
        required_missions = { vn_por_papal_relations }
        completed_by = 1373.1.1
        trigger = {
            government_rank = 5
            is_subject = no
            tag = POR
            if = {
                limit = { exists = ASE }
                reverse_has_opinion = {
                    who = ASE
                    value = 125
                }
                alliance_with = ASE
            }
            else_if = {
                limit = { exists = ENG }
                reverse_has_opinion = {
                    who = ENG
                    value = 125
                }
                alliance_with = ENG 
            }
            else = {
                any_ally = {
                    OR = {
                        primary_culture = anglosaxon
                        primary_culture = english
                    }
                    has_opinion = {
                        who = ROOT
                        value = 125
                    }
                    alliance_with = ROOT
                }
            }
        }
        effect = {
            add_country_modifier = {
                name = "por_alliance_with_england_mission"
                duration = 9125
            }
        }
    }
}